<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>OpShieldWall on Jaybird1291</title><link>https://jaybird1291.github.io/blog/tags/opshieldwall/</link><description>Recent content in OpShieldWall on Jaybird1291</description><generator>Hugo -- gohugo.io</generator><language>fr</language><lastBuildDate>Sun, 19 May 2024 08:00:05 +0000</lastBuildDate><atom:link href="https://jaybird1291.github.io/blog/tags/opshieldwall/index.xml" rel="self" type="application/rss+xml"/><item><title>OpShieldWall-2</title><link>https://jaybird1291.github.io/blog/p/opshieldwall-2/</link><pubDate>Sun, 19 May 2024 08:00:05 +0000</pubDate><guid>https://jaybird1291.github.io/blog/p/opshieldwall-2/</guid><description>&lt;img src="https://jaybird1291.github.io/blog/p/opshieldwall-2/OpShieldWall-2.jpg" alt="Featured image of post OpShieldWall-2" />&lt;h2 id="scÃ©nario">ScÃ©nario
&lt;/h2>&lt;blockquote>
&lt;p>Nous avons rÃ©ussi Ã  confirmer la localisation de l&amp;rsquo;acteur malveillant qui a compromis le rÃ©seau WiFi de notre gouvernement.&lt;/p>
&lt;p>RÃ©cemment, un raid Ã  l&amp;rsquo;aube dans le cadre de l&amp;rsquo;OP ERADICATE a Ã©tÃ© menÃ© Ã  une adresse dans la capitale vÃ©lorienne et une quantitÃ© considÃ©rable d&amp;rsquo;Ã©lÃ©ments de preuve a Ã©tÃ© saisie. On notera en particulier un appareil Android appartenant Ã  l&amp;rsquo;agent, dont on pense qu&amp;rsquo;il se trouvait sur le lieu de l&amp;rsquo;attaque.&lt;/p>
&lt;p>Nous avons besoin de votre expertise pour analyser cet appareil et rÃ©pondre aux questions dÃ©taillÃ©es ci-dessous. Vous n&amp;rsquo;avez pas beaucoup de temps, une rÃ©union du COBR vÃ©lorien a Ã©tÃ© organisÃ©e pour discuter de vos rÃ©sultats&amp;hellip;&lt;/p>
&lt;/blockquote>
&lt;h2 id="fichiers">Fichiers
&lt;/h2>&lt;ul>
&lt;li>opshieldwall2.zip contenant &amp;ldquo;EVIDENCE-CASE-RAVENSKIAN-AGENT-002&amp;rdquo; oÃ¹ on le retrouve le dossier &amp;ldquo;data&amp;rdquo; et &amp;ldquo;storage&amp;rdquo; d&amp;rsquo;un Android&lt;/li>
&lt;/ul>
&lt;p>Cela nous laisse pas mal de marge de manÅ“uvre, en effet, le /data contient Ã©normÃ©ment d&amp;rsquo;informations telles que :&lt;/p>
&lt;div class="image2-container">
&lt;div class="image">
&lt;figure>
&lt;a href="pictures/cheatsheet-sans-for585.png">
&lt;img src="https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/cheatsheet-sans-for585.png" srcset="https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/cheatsheet-sans-for585_hu16155672487987992094.png 360w, https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/cheatsheet-sans-for585_hu11289631915745235764.png 720w, https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/cheatsheet-sans-for585_hu12009676279544424470.png 1920w" sizes="(max-width: 37.5em) 360px, (min-width: 75em) 720px, (min-width: 112.5em) 1200px" width="320" />
&lt;/a>
&lt;figcaption>
Cheatsheet SANS FOR585
&lt;/figcaption>
&lt;/figure>
&lt;/div>
&lt;/div>
&lt;h2 id="avant-propos">Avant propos
&lt;/h2>&lt;p>Avant de commencer, voici quelques informations importantes sur Android :&lt;/p>
&lt;p>Les donnÃ©es utilisateur peuvent Ãªtre stockÃ©es en interne et en externe sur Android. Les donnÃ©es internes sont enregistrÃ©es dans la mÃ©moire flash NAND, une mÃ©moire non volatile qui conserve les donnÃ©es mÃªme en cas de coupure d&amp;rsquo;alimentation. La NAND stocke le bootloader, le systÃ¨me d&amp;rsquo;exploitation et les donnÃ©es utilisateur. Les donnÃ©es des applications sont stockÃ©es sur la mÃ©moire flash NAND ou sur la carte SD.&lt;/p>
&lt;p>Android est basÃ© sur des variantes des branches LTS (long-term support) du Kernel Linux. Avec Android v8 (Oreo), Google a imposÃ© l&amp;rsquo;utilisation de la version 4.4 ou supÃ©rieur du Kernel Linux. Par exemple Android v9 (Pie) fonctionne sur les versions 4.4, 4.9 ou 4.14 selon l&amp;rsquo;appareil. Plus d&amp;rsquo;info disponnible sur le wiki d&amp;rsquo;Android OS &lt;a class="link" href="https://source.android.com/docs/core/architecture/kernel/android-common?hl=fr" target="_blank" rel="noopener"
>https://source.android.com/docs/core/architecture/kernel/android-common?hl=fr&lt;/a>.&lt;/p>
&lt;p>&lt;code>android-mainline&lt;/code>Â est la principale branche de dÃ©veloppement des fonctionnalitÃ©s Android. La ligne principale Linux est fusionnÃ©e avecÂ &lt;code>android-mainline&lt;/code>Â chaque fois que Linus Torvalds publie une version ou une version candidate :&lt;/p>
&lt;p>&lt;img src="https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/android-branches.png"
width="932"
height="720"
srcset="https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/android-branches_hu11681531264120324004.png 480w, https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/android-branches_hu8683411598684431168.png 1024w"
loading="lazy"
alt="Android Common Kemel Branching Model"
class="gallery-image"
data-flex-grow="129"
data-flex-basis="310px"
>&lt;/p>
&lt;p>On retrouve principalement ces systÃ¨mes de fichiers :&lt;/p>
&lt;ul>
&lt;li>EXT4&lt;/li>
&lt;li>F2FS&lt;/li>
&lt;li>YAFFS2&lt;/li>
&lt;li>exFAT&lt;/li>
&lt;/ul>
&lt;p>La plupart des artefacts sont des DB SQLite et des fichiers XML. Android isole les applications au niveau du Kernel, leur attribuant un identifiant unique (UID) pour suivre les applications exÃ©cutÃ©es.&lt;/p>
&lt;h3 id="android-architecture">Android Architecture
&lt;/h3>&lt;p>&lt;img src="https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/android-architecture.png"
width="549"
height="815"
srcset="https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/android-architecture_hu8710287640414005145.png 480w, https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/android-architecture_hu7157129161549664279.png 1024w"
loading="lazy"
alt="Architecture"
class="gallery-image"
data-flex-grow="67"
data-flex-basis="161px"
>&lt;/p>
&lt;ul>
&lt;li>
&lt;p>Le noyau Linux constitue la base d&amp;rsquo;Android, supportant des fonctionnalitÃ©s cruciales telles que les threads et la gestion de la mÃ©moire de bas niveau utilisÃ©es par Android Runtime (ART).&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Le HAL fournit des interfaces standardisÃ©es qui exposent les fonctionnalitÃ©s matÃ©rielles aux API Java de niveau supÃ©rieur. Il est composÃ© de modules de bibliothÃ¨que spÃ©cifiques Ã  chaque composant matÃ©riel (comme la camÃ©ra ou le Bluetooth). Lorsqu&amp;rsquo;une API accÃ¨de au matÃ©riel, Android charge le module de bibliothÃ¨que correspondant&lt;/p>
&lt;/li>
&lt;li>
&lt;p>L&amp;rsquo;environnement d&amp;rsquo;exÃ©cution Android (Android Runtime dit ART) exÃ©cute chaque application dans son propre processus et instance. GÃ©rant plusieurs machines virtuelles sur des appareils Ã  faible mÃ©moire grÃ¢ce au bytecode DEX spÃ©cialement conÃ§u et optimisÃ© pour Android. Les outils de compilation comme d8 transforment le code Java en bytecode DEX pour l&amp;rsquo;exÃ©cution sur Android.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>De nombreux composants et services systÃ¨me Android essentiels, tels qu&amp;rsquo;ART et HAL, sont crÃ©Ã©s Ã  partir de code natif nÃ©cessitant des bibliothÃ¨ques natives Ã©crites en C et C++.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Les fonctionnalitÃ©s d&amp;rsquo;Android sont accessibles via des API Java, facilitant la rÃ©utilisation des principaux composants et services systÃ¨me modulaires comme les notifications, la gestion des ressources et la localisation.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Les applications systÃ¨me sont l&amp;rsquo;ensemble des applications de base fournies avec Android.&lt;/p>
&lt;/li>
&lt;/ul>
&lt;h3 id="android-virtual-machine">Android Virtual Machine
&lt;/h3>&lt;p>&lt;img src="https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/android-vm.png"
width="235"
height="258"
srcset="https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/android-vm_hu9996704157503076210.png 480w, https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/android-vm_hu12750818963076190994.png 1024w"
loading="lazy"
alt="Android Virtual Machine"
class="gallery-image"
data-flex-grow="91"
data-flex-basis="218px"
>&lt;/p>
&lt;ul>
&lt;li>
&lt;p>Les VM sont utilisÃ©s comme couches d&amp;rsquo;abstraction entre une application et l&amp;rsquo;appareil Android sous-jacent.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Chaque application fonctionne dans sa propre instance dans une VM, isolant les applications les unes des autres.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Les applications Android sont Ã©crites en Java mais sont compilÃ©es et compilÃ©es en bytecode Java.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Ce bytecode est ensuite transformÃ© en bytecode Dalvik (fichiers .dex) ou bytecode ART.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Dalvik et ART exÃ©cutent le bytecode (.dex) dans une machine virtuelle, permettant aux applications de fonctionner indÃ©pendamment du matÃ©riel sous-jacent.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Avant KitKat (v.4.4), Android utilisait des VM Dalvik.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Avec Lollipop (v5.0), Android a commencÃ© Ã  utiliser Android Runtime (ART) et a cessÃ© d&amp;rsquo;utiliser la VM Dalvik.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Les deux environnements d&amp;rsquo;exÃ©cution Dalvik et ART fonctionnent avec le bytecode DEX, mais ART possÃ¨de de nouvelles fonctionnalitÃ©s d&amp;rsquo;optimisation.&lt;/p>
&lt;/li>
&lt;/ul>
&lt;h3 id="directory-structure">Directory structure
&lt;/h3>&lt;p>&lt;img src="https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/directory-structure.png"
width="691"
height="682"
srcset="https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/directory-structure_hu1759560322735221499.png 480w, https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/directory-structure_hu3151186207932460450.png 1024w"
loading="lazy"
alt="Directory structure"
class="gallery-image"
data-flex-grow="101"
data-flex-basis="243px"
>&lt;/p>
&lt;ul>
&lt;li>&lt;strong>/cache&lt;/strong> : peut contenir des piÃ¨ces jointes gmail, des tÃ©lÃ©chargements, des donnÃ©es de navigation et des mises Ã  jour OTA&lt;/li>
&lt;li>&lt;strong>/efs&lt;/strong> : contient des fichiers nÃ©cessaires au fonctionnement de l&amp;rsquo;appareil en cas de dÃ©faillance&lt;/li>
&lt;li>&lt;strong>/data&lt;/strong> :
&lt;ul>
&lt;li>&lt;strong>/data/data&lt;/strong> : contient les dossiers des applications (&lt;code>/data/data/com.example.app&lt;/code>), les fichiers de configurations des apps, les DB SQLite des apps, leurs logs, cache etc.&lt;/li>
&lt;li>&lt;strong>/app&lt;/strong> : contient des fichiers .apk du marchÃ© Android *Des malwares peuvent Ãªtre trouvÃ©s ici&lt;/li>
&lt;li>&lt;strong>/backup&lt;/strong> : stocke l&amp;rsquo;API de sauvegarde pour les dÃ©veloppeurs donc les donnÃ©es de sauvegarde des utilisateurs ne sont pas stockÃ©es ici&lt;/li>
&lt;li>&lt;strong>/media&lt;/strong> : l&amp;rsquo;emplacement de stockage interne Ã©quivalent Ã  une carte SD. *Des malwares malveillants peuvent Ãªtre trouvÃ©s ici&lt;/li>
&lt;li>&lt;strong>/misc&lt;/strong> : les fichiers liÃ©s Ã  Bluetooth, dhcp, vpn, Wi-Fi, etc. sont stockÃ©s ici&lt;/li>
&lt;li>&lt;strong>/system&lt;/strong> : contient des fichiers clÃ©s tels que gesture.key et passwords.key ; le fichier accounts.db qui contient les usernames et les mots de passe pour l&amp;rsquo;authentification des fichiers etc.&lt;/li>
&lt;li>&lt;strong>/property&lt;/strong> : contient les propriÃ©tÃ©s du systÃ¨me, y compris le fuseau horaire, les paramÃ¨tres de langue, etc.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;strong>/mnt&lt;/strong> :
&lt;ul>
&lt;li>&lt;strong>/asec&lt;/strong> : stocke les donnÃ©es non chiffrÃ©s des apps&lt;/li>
&lt;li>&lt;strong>/DCIM&lt;/strong> : stocke les thumbnails des albums&lt;/li>
&lt;li>&lt;strong>/Pictures&lt;/strong> : stocke les images de l&amp;rsquo;appareil photo&lt;/li>
&lt;li>&lt;strong>/downloads&lt;/strong> : fichiers tÃ©lÃ©chargÃ©s localement&lt;/li>
&lt;li>&lt;strong>/secure/asec&lt;/strong> : stocke les donnÃ©es chiffrÃ©s des apps&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;strong>/system&lt;/strong> :
&lt;ul>
&lt;li>&lt;strong>/app&lt;/strong> : contient des fichiers .apk. *Des malwares peuvent Ãªtre trouvÃ©s ici&lt;/li>
&lt;li>&lt;strong>/priv-app&lt;/strong> : contient des fichiers &amp;amp; apk avec des permissions au niveau du systÃ¨me. *Des malwares peuvent Ãªtre trouvÃ©s ici&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;p>Pour avoir plus d&amp;rsquo;informations sur&lt;/p>
&lt;ul>
&lt;li>les permissions des app : &lt;a class="link" href="https://developer.android.com/guide/topics/permissions/overview?hl=fr" target="_blank" rel="noopener"
>https://developer.android.com/guide/topics/permissions/overview?hl=fr&lt;/a> ; &lt;a class="link" href="https://blog.mindorks.com/what-are-the-different-protection-levels-in-android-permission/" target="_blank" rel="noopener"
>https://blog.mindorks.com/what-are-the-different-protection-levels-in-android-permission/&lt;/a>&lt;/li>
&lt;li>la CLI d&amp;rsquo;Android : &lt;a class="link" href="https://developer.android.com/tools/adb?hl=fr" target="_blank" rel="noopener"
>https://developer.android.com/tools/adb?hl=fr&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="setup">Setup
&lt;/h2>&lt;p>Au vu des fichiers et du scÃ©nario, je vais utiliser l&amp;rsquo;outil Autopsy. Cela peut prendre un peu de temps Ã  ce setup, c&amp;rsquo;est pour cela que j&amp;rsquo;attaque cela ici.&lt;/p>
&lt;p>Si vous ne connaissez pas Autopsy, voici une briÃ¨ve description :&lt;/p>
&lt;blockquote>
&lt;p>Autopsy est un outil d&amp;rsquo;investigation numÃ©rique opensource. Il se rapporte Ã  l&amp;rsquo;interface graphique du Sleuth Kit et d&amp;rsquo;autres outils de forensic. Il est utilisÃ© pour analyser des disques durs et des smartphones dans le cadre d&amp;rsquo;enquÃªtes. Les fonctionnalitÃ©s clÃ©s d&amp;rsquo;Autopsy incluent la rÃ©cupÃ©ration de fichiers supprimÃ©s, l&amp;rsquo;analyse des mÃ©tadonnÃ©es, la recherche par mots-clÃ©s, la visualisation des timelines d&amp;rsquo;activitÃ©s, et l&amp;rsquo;analyse des systÃ¨mes de fichiers etc.&lt;/p>
&lt;/blockquote>
&lt;p>Pour l&amp;rsquo;utiliser, nous devons crÃ©er une &amp;ldquo;Case&amp;rdquo; :&lt;/p>
&lt;p>&lt;img src="https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/autopsy-case.png"
width="782"
height="468"
srcset="https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/autopsy-case_hu6083939050916543242.png 480w, https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/autopsy-case_hu10757773130814133319.png 1024w"
loading="lazy"
alt="Autopsy"
class="gallery-image"
data-flex-grow="167"
data-flex-basis="401px"
>&lt;/p>
&lt;!-- &lt;div class="image2-container">
&lt;div class="image">
&lt;figure>
&lt;a href="pictures/autopsy-case.png">
&lt;img src="https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/autopsy-case.png" srcset="https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/autopsy-case_hu10571252955474266221.png 360w, https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/autopsy-case_hu12163003742284739222.png 720w, https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/autopsy-case_hu15699116795484705861.png 1920w" sizes="(max-width: 37.5em) 360px, (min-width: 75em) 720px, (min-width: 112.5em) 1200px" width="620" />
&lt;/a>
&lt;/figure>
&lt;/div>
&lt;/div> -->
&lt;p>Ici, nous savons que nous n&amp;rsquo;avons pas Ã  faire Ã  une &amp;ldquo;Disk Image&amp;rdquo; ou Ã  une VM, de mÃªme pour un disque local. Nous choisissons donc l&amp;rsquo;option appropriÃ©e &amp;ldquo;Logical Files&amp;rdquo; :&lt;/p>
&lt;p>&lt;img src="https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/autopsy-type.png"
width="861"
height="543"
srcset="https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/autopsy-type_hu6862495736605752197.png 480w, https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/autopsy-type_hu13735227138581635848.png 1024w"
loading="lazy"
alt="Autopsy"
class="gallery-image"
data-flex-grow="158"
data-flex-basis="380px"
>&lt;/p>
&lt;!-- &lt;div class="image2-container">
&lt;div class="image">
&lt;figure>
&lt;a href="pictures/autopsy-type.png">
&lt;img src="https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/autopsy-type.png" srcset="https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/autopsy-type_hu10259340970336895008.png 360w, https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/autopsy-type_hu10231070479329917598.png 720w, https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/autopsy-type_hu8278487795151172247.png 1920w" sizes="(max-width: 37.5em) 360px, (min-width: 75em) 720px, (min-width: 112.5em) 1200px" width="620" />
&lt;/a>
&lt;/figure>
&lt;/div>
&lt;/div> -->
&lt;p>On attend qu&amp;rsquo;Autopsy &amp;amp; ses modules terminent l&amp;rsquo;ingestion. Cela peut prendre un moment.&lt;/p>
&lt;p>C&amp;rsquo;est bon, on peut commencer l&amp;rsquo;investigation :&lt;/p>
&lt;p>&lt;img src="https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/autopsy-ingestion.png"
width="950"
height="551"
srcset="https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/autopsy-ingestion_hu8847970414139715284.png 480w, https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/autopsy-ingestion_hu5619979587414845525.png 1024w"
loading="lazy"
alt="Autopsy"
class="gallery-image"
data-flex-grow="172"
data-flex-basis="413px"
>&lt;/p>
&lt;!-- &lt;div class="image2-container">
&lt;div class="image">
&lt;figure>
&lt;a href="pictures/autopsy-ingestion.png">
&lt;img src="https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/autopsy-ingestion.png" srcset="https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/autopsy-ingestion_hu5021449277738356024.png 360w, https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/autopsy-ingestion_hu5953934403159561371.png 720w, https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/autopsy-ingestion_hu1274128389175726007.png 1920w" sizes="(max-width: 37.5em) 360px, (min-width: 75em) 720px, (min-width: 112.5em) 1200px" width="620" />
&lt;/a>
&lt;/figure>
&lt;/div>
&lt;/div> -->
&lt;h2 id="questions">Questions
&lt;/h2>&lt;h3 id="question-1">Question 1
&lt;/h3>&lt;h4 id="quelle-est-ladresse-mail-de-lagent-qui-a-Ã©tÃ©-utilisÃ©e-dans-diverses-applicationsservices-">Quelle est l&amp;rsquo;adresse mail de l&amp;rsquo;agent qui a Ã©tÃ© utilisÃ©e dans diverses applications/services ?
&lt;/h4>&lt;p>Pour y rÃ©pondre, je vais utiliser le rapport qu&amp;rsquo;Autopsy a gÃ©nÃ©rÃ© via ALEAPP (Android Logs Events And Protobuf Parser), un projet open-source qui vise Ã  analyser tous les artefacts Android connus Ã  des fins d&amp;rsquo;analyse forensic.&lt;/p>
&lt;p>Pour trouver rapidement et simplement nous pouvons chercher dans :&lt;/p>
&lt;ul>
&lt;li>&lt;code>/data/data/com.android.vending/databases/library.db&lt;/code> pour y trouver le compte google utilisÃ© pour download des apps&lt;/li>
&lt;/ul>
&lt;p>&lt;img src="https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/library-db.png"
width="1106"
height="416"
srcset="https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/library-db_hu14356497083862899817.png 480w, https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/library-db_hu15170373232235569335.png 1024w"
loading="lazy"
alt="library.db"
class="gallery-image"
data-flex-grow="265"
data-flex-basis="638px"
>&lt;/p>
&lt;ul>
&lt;li>&lt;code>/data/data/com.android.providers.contacts/databases/contacts2.db&lt;/code> pour y trouver le compte google utilisÃ© pour synchroniser ses contacts&lt;/li>
&lt;/ul>
&lt;p>&lt;img src="https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/contacts2-db.png"
width="391"
height="238"
srcset="https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/contacts2-db_hu11527735429286072776.png 480w, https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/contacts2-db_hu17764455955817381113.png 1024w"
loading="lazy"
alt="contacts2.db"
class="gallery-image"
data-flex-grow="164"
data-flex-basis="394px"
>&lt;/p>
&lt;p>Mais aussi (mais non applicable sur ce challenge) ici :&lt;/p>
&lt;ul>
&lt;li>&lt;code>/data/com.android.vending/shared_prefs/lastaccount.xml&lt;/code> (dernier compte utilisÃ© sur Google PlayStore (Android 9 et plus))&lt;/li>
&lt;li>&lt;code>/data/com.google.android.gms/shared_prefs/BackupAccount.xml&lt;/code> (email du compte de backup)&lt;/li>
&lt;li>&lt;code>/data/com.android.email/databases/EmailProvider.db&lt;/code> (email accounts, 3rd party app data et les messages associÃ©s aux notifications par emails)&lt;/li>
&lt;/ul>
&lt;p>Enfin bref, on se retrouve donc avec le rapport en format html :&lt;/p>
&lt;p>&lt;img src="https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/aleapp.png"
width="1305"
height="1293"
srcset="https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/aleapp_hu7130096182844556435.png 480w, https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/aleapp_hu12263893790261698615.png 1024w"
loading="lazy"
alt="ALEAPP"
class="gallery-image"
data-flex-grow="100"
data-flex-basis="242px"
>&lt;/p>
&lt;!--
&lt;div class="image2-container">
&lt;div class="image">
&lt;figure>
&lt;a href="pictures/aleapp.png">
&lt;img src="https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/aleapp.png" srcset="https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/aleapp_hu14425811290376317999.png 360w, https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/aleapp_hu15982933620649972970.png 720w, https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/aleapp_hu3249029777657563161.png 1920w" sizes="(max-width: 37.5em) 360px, (min-width: 75em) 720px, (min-width: 112.5em) 1200px" width="720" />
&lt;/a>
&lt;/figure>
&lt;/div>
&lt;/div> -->
&lt;p>On peut retrouver son adresse mail un peu partout.&lt;/p>
&lt;p>Dans l&amp;rsquo;app &amp;ldquo;Chrome&amp;rdquo; par exemple avec la partie &amp;ldquo;Autofill&amp;rdquo; (fonctionnalitÃ© qui permet de remplir automatiquement des formulaires avec des informations prÃ©enregistrÃ©es) :&lt;/p>
&lt;p>&lt;img src="https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/chrome-autofill.png"
width="1055"
height="246"
srcset="https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/chrome-autofill_hu11332893087194299595.png 480w, https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/chrome-autofill_hu11223589903272610126.png 1024w"
loading="lazy"
alt="Chrome Autofill"
class="gallery-image"
data-flex-grow="428"
data-flex-basis="1029px"
>&lt;/p>
&lt;p>Dans les &amp;ldquo;Login Data&amp;rdquo; de Chrome :&lt;/p>
&lt;p>&lt;img src="https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/chrome-login.png"
width="1059"
height="245"
srcset="https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/chrome-login_hu17712187877154962798.png 480w, https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/chrome-login_hu16446215484735778592.png 1024w"
loading="lazy"
alt="Chrome Login Data"
class="gallery-image"
data-flex-grow="432"
data-flex-basis="1037px"
>&lt;/p>
&lt;p>Enfin dans la partie &amp;ldquo;Installed Apps (Library)&amp;rdquo; nous retrouvons l&amp;rsquo;adresse mail du compte google utilisÃ© pour download des apps :&lt;/p>
&lt;p>&lt;img src="https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/installed-app-library.png"
width="1063"
height="316"
srcset="https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/installed-app-library_hu13714229813044265702.png 480w, https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/installed-app-library_hu16148577922576020004.png 1024w"
loading="lazy"
alt="Installed App (Library)"
class="gallery-image"
data-flex-grow="336"
data-flex-basis="807px"
>&lt;/p>
&lt;p>&lt;strong>RÃ©ponse&lt;/strong> :
&lt;code>olegpachinksy@gmail.com&lt;/code>&lt;/p>
&lt;h3 id="question-2">Question 2
&lt;/h3>&lt;h4 id="quel-est-le-numÃ©ro-de-contact-du-gestionnaire-handler-affectÃ©-Ã -lagent-qui-a-Ã©tÃ©-arrÃªtÃ©-">Quel est le numÃ©ro de contact du gestionnaire (handler) affectÃ© Ã  l&amp;rsquo;agent qui a Ã©tÃ© arrÃªtÃ© ?
&lt;/h4>&lt;p>Dans la partie &amp;ldquo;Contacts&amp;rdquo; :&lt;/p>
&lt;p>&lt;img src="https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/contacts.png"
width="1053"
height="152"
srcset="https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/contacts_hu6587797369375758064.png 480w, https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/contacts_hu2168626199806216219.png 1024w"
loading="lazy"
alt="Contacts"
class="gallery-image"
data-flex-grow="692"
data-flex-basis="1662px"
>&lt;/p>
&lt;p>&lt;strong>RÃ©ponse&lt;/strong> :
&lt;code>+323145232315&lt;/code>&lt;/p>
&lt;h3 id="question-3">Question 3
&lt;/h3>&lt;h4 id="rÃ©cupÃ©rer-les-identifiants-et-le-lien-du-portail-officiel-des-agents-ravenskiens-cela-peut-nous-donner-un-avantage-en-matiÃ¨re-de-renseignement-car-nous-pouvons-utiliser-cet-accÃ¨s-pour-obtenir-dautres-informations-exploitables-sur-les-opÃ©rations-que-le-gouvernement-ravenskien-planifie">RÃ©cupÃ©rer les identifiants et le lien du portail officiel des agents ravenskiens. Cela peut nous donner un avantage en matiÃ¨re de renseignement car nous pouvons utiliser cet accÃ¨s pour obtenir d&amp;rsquo;autres informations exploitables sur les opÃ©rations que le gouvernement ravenskien planifie.
&lt;/h4>&lt;p>Nous avons dÃ©jÃ  trouvÃ© la rÃ©ponse Ã  cette question Ã  la question nÂ°1 via les &amp;ldquo;Login Data&amp;rdquo; de Chrome :&lt;/p>
&lt;p>&lt;img src="https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/chrome-login2.png"
width="1055"
height="240"
srcset="https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/chrome-login2_hu15296478488851435636.png 480w, https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/chrome-login2_hu11746730972429607906.png 1024w"
loading="lazy"
alt="Chrome Login Data"
class="gallery-image"
data-flex-grow="439"
data-flex-basis="1055px"
>&lt;/p>
&lt;p>&lt;strong>RÃ©ponse&lt;/strong> :
&lt;code>agent.ravensk.idu.com:olegpachinksy007:HBLKNKD0MADsdfsa2334(*&amp;amp;DSMDB&lt;/code>&lt;/p>
&lt;h3 id="question-4">Question 4
&lt;/h3>&lt;h4 id="quel-est-le-code-de-contact-utilisÃ©-pour-confirmer-lidentitÃ©-de-lagent-et-du-gestionnaire-lors-de-lutilisation-dun-canal-de-discussion-sÃ©curisÃ©-">Quel est le code de contact utilisÃ© pour confirmer l&amp;rsquo;identitÃ© de l&amp;rsquo;agent et du gestionnaire lors de l&amp;rsquo;utilisation d&amp;rsquo;un canal de discussion sÃ©curisÃ© ?
&lt;/h4>&lt;p>PremiÃ¨rement je vais vÃ©rifier les potentiels SMS ici : &lt;code>/data/data/com.android.providers.telephony/databases/mmssms.db&lt;/code>.&lt;/p>
&lt;p>&lt;img src="https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/mmssms-db.png"
width="959"
height="1197"
srcset="https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/mmssms-db_hu14772761795677474013.png 480w, https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/mmssms-db_hu3808283121989879023.png 1024w"
loading="lazy"
alt="mmssms.db"
class="gallery-image"
data-flex-grow="80"
data-flex-basis="192px"
>&lt;/p>
&lt;p>Nous n&amp;rsquo;y trouvons rien.&lt;/p>
&lt;p>Nous pourrions aussi chercher ici mais non applicable sur ce challenge :&lt;/p>
&lt;ul>
&lt;li>&lt;code>/data/com.google.android.gms/databases/icing_mmssms.db&lt;/code> (SMS/MMS)&lt;/li>
&lt;li>&lt;code>/data/com.google.android.gms/databases/ipa_mmssms.db&lt;/code> (SMS/MMS)&lt;/li>
&lt;/ul>
&lt;p>Nous devons donc trouver l&amp;rsquo;app de messagerie utilisÃ©. On peut voir toutes les apps installÃ©es dans la partie &amp;ldquo;Installed Programs&amp;rdquo; d&amp;rsquo;Autopsy :&lt;/p>
&lt;p>&lt;img src="https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/installed-apps.png"
width="880"
height="748"
srcset="https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/installed-apps_hu3650820897931429960.png 480w, https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/installed-apps_hu171029572481239251.png 1024w"
loading="lazy"
alt="Installed Programs"
class="gallery-image"
data-flex-grow="117"
data-flex-basis="282px"
>&lt;/p>
&lt;p>On y trouve diffÃ©rente catÃ©gorie :&lt;/p>
&lt;ul>
&lt;li>Installed Apps (GMS)&lt;/li>
&lt;li>Installed Apps (Library)&lt;/li>
&lt;li>Installed Apps (Vending)&lt;/li>
&lt;/ul>
&lt;p>&lt;strong>Installed Apps - GMS&lt;/strong> :
Cette catÃ©gorie concerne les applications installÃ©es sur l&amp;rsquo;appareil, quel que soit leur mode d&amp;rsquo;installation. On peut retrouver ces donnÃ©es ici :Â &lt;code>/data/com.google.android.gms/databases/&lt;/code>.&lt;/p>
&lt;p>&lt;strong>Installed Apps - Library&lt;/strong> :
Cette catÃ©gorie se rÃ©fÃ¨re Ã  la bibliothÃ¨que d&amp;rsquo;applications pour l&amp;rsquo;utilisateur Google utilisant l&amp;rsquo;appareil. Il est important de noter que cette DB n&amp;rsquo;est pas liÃ©e aux applications installÃ©es sur l&amp;rsquo;appareil, elle peut contenir des applications installÃ©es par le mÃªme compte Google sur un autre appareil ou sur une prÃ©cÃ©dente installation de l&amp;rsquo;appareil analysÃ©. On peut retrouver ces donnÃ©es ici :Â &lt;code>/data/com.android.vending/databases/&lt;/code>.&lt;/p>
&lt;p>&lt;strong>Installed Apps - Vending&lt;/strong> :
Cette catÃ©gorie concerne spÃ©cifiquement les applications installÃ©es sur l&amp;rsquo;appareil via le Google Play Store, excluant celles installÃ©es par d&amp;rsquo;autres moyens. Ces donnÃ©es ne sont pas supprimÃ©es lorsque l&amp;rsquo;application est dÃ©sinstallÃ©e. Elles sont stockÃ©es dans une DB SQLite situÃ©e ici : &lt;code>/data/com.android.vending/databases/&lt;/code>.&lt;/p>
&lt;p>Pour plus de lisibilitÃ© retournons sur ALEAPP et concentrons-nous sur les apps de type &amp;ldquo;Vending&amp;rdquo; :&lt;/p>
&lt;p>&lt;img src="https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/aleapp-installed-app-vending.png"
width="1055"
height="626"
srcset="https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/aleapp-installed-app-vending_hu1141038315898512112.png 480w, https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/aleapp-installed-app-vending_hu13659998016684563510.png 1024w"
loading="lazy"
alt="ALEAPP - Installed Apps (Vending)"
class="gallery-image"
data-flex-grow="168"
data-flex-basis="404px"
>&lt;/p>
&lt;p>L&amp;rsquo;app qui saute au yeux c&amp;rsquo;est &lt;code>mega.privacy.android.app&lt;/code>. Et en effet, c&amp;rsquo;est une application de messagerie :&lt;/p>
&lt;p>&lt;img src="https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/mega.png"
width="781"
height="734"
srcset="https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/mega_hu1189030808320422895.png 480w, https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/mega_hu16736818150663509043.png 1024w"
loading="lazy"
alt="MEGA"
class="gallery-image"
data-flex-grow="106"
data-flex-basis="255px"
>&lt;/p>
&lt;p>Justement ALEAPP a parsÃ© les messages Ã©changÃ©s via MEGA :&lt;/p>
&lt;p>&lt;img src="https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/mega-messages.png"
width="1045"
height="942"
srcset="https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/mega-messages_hu15900992541428924357.png 480w, https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/mega-messages_hu16724471899791683972.png 1024w"
loading="lazy"
alt="Messages"
class="gallery-image"
data-flex-grow="110"
data-flex-basis="266px"
>&lt;/p>
&lt;p>On peut retrouver ces infomations ici : &lt;code>/data/data/mega.privacy.android.app/karere-TU1IaTh4TUJpdTQKAfO_2P0qU8NMP7zDRlgv.db&lt;/code>.&lt;/p>
&lt;p>&lt;strong>RÃ©ponse&lt;/strong> :
&lt;code>REDAPPLEONACAR&lt;/code>&lt;/p>
&lt;h3 id="question-5">Question 5
&lt;/h3>&lt;h4 id="le-gestionnaire-a-partagÃ©-un-document-avec-lagent-en-utilisant-un-service-de-stockage-cloud-quand-ce-fichier-a-t-il-Ã©tÃ©-partagÃ©-avec-lagent-">Le gestionnaire a partagÃ© un document avec l&amp;rsquo;agent en utilisant un service de stockage cloud. Quand ce fichier a-t-il Ã©tÃ© partagÃ© avec l&amp;rsquo;agent ?
&lt;/h4>&lt;p>Rien dans les messages. Le document a donc dÃ» Ãªtre transmis d&amp;rsquo;une autre maniÃ¨re. Nous savons qu&amp;rsquo;il n&amp;rsquo;y a pas d&amp;rsquo;autre app de messagerie et qu&amp;rsquo;il n&amp;rsquo;a pas pu lui communiquer via SMS/MMS.&lt;/p>
&lt;p>Dans les app installÃ© nous avons vu &lt;code>com.google.android.apps.docs&lt;/code>. Allons donc chercher ici : &lt;code>\data\data\com.google.android.apps.docs&lt;/code>.&lt;/p>
&lt;p>On y trouve la DB &lt;code>/data/data/com.google.android.apps.docs/app_cello/olegpachinksy@gmail.com/cello.db&lt;/code> contenant ces informations :&lt;/p>
&lt;p>&lt;img src="https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/celo-db.png"
width="1033"
height="240"
srcset="https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/celo-db_hu13525151425253133660.png 480w, https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/celo-db_hu12549832181728511141.png 1024w"
loading="lazy"
alt="celo.db"
class="gallery-image"
data-flex-grow="430"
data-flex-basis="1033px"
>&lt;/p>
&lt;p>On peut d&amp;rsquo;ailleurs retrouver ce fichier ici : &lt;code>EVIDENCE-CASE-RAVENSKIAN-AGENT-002/storage/emulated/0/Download/Debrief-Velorian OP Expansion East.pdf&lt;/code> :&lt;/p>
&lt;p>&lt;img src="https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/debrief-velorian-op.png"
width="1270"
height="999"
srcset="https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/debrief-velorian-op_hu7260486241203699891.png 480w, https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/debrief-velorian-op_hu4913527138095684519.png 1024w"
loading="lazy"
alt="Debrief-Velorian OP Expansion East"
class="gallery-image"
data-flex-grow="127"
data-flex-basis="305px"
>&lt;/p>
&lt;p>NÃ©anmoins attention, par dÃ©faut Autopsy interprÃ¨te les timestamps avec la time zone de votre ordinateur. Pensez bien Ã  modifier ce paramÃ¨tre dans Autopsy (Tools &amp;gt; Options &amp;gt; View &amp;gt; Time Zone).&lt;/p>
&lt;p>&lt;strong>RÃ©ponse&lt;/strong> :
&lt;code>2024-04-01 09:36:41&lt;/code>&lt;/p>
&lt;h3 id="question-6">Question 6
&lt;/h3>&lt;h4 id="quel-est-luri-de-tÃ©lÃ©chargement-du-fichier-partagÃ©-prÃ©cÃ©demment-identifiÃ©-">Quel est l&amp;rsquo;URI de tÃ©lÃ©chargement du fichier partagÃ© prÃ©cÃ©demment identifiÃ© ?
&lt;/h4>&lt;p>Nous savons que le fichier a Ã©tÃ© tÃ©lÃ©chargÃ© car nous l&amp;rsquo;avons retrouvÃ© dans &lt;code>/storage/emulated/0/Download/&lt;/code>.&lt;/p>
&lt;p>Nous pouvons donc chercher dans &lt;code>/data/data/com.android.providers.downloads/databases/downloads.db&lt;/code> :&lt;/p>
&lt;p>&lt;img src="https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/downloads-db.png"
width="1038"
height="262"
srcset="https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/downloads-db_hu8655702280366484884.png 480w, https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/downloads-db_hu14956409061816301645.png 1024w"
loading="lazy"
alt="downloads.db"
class="gallery-image"
data-flex-grow="396"
data-flex-basis="950px"
>&lt;/p>
&lt;p>&lt;strong>RÃ©ponse&lt;/strong> :
&lt;code>https://www.googleapis.com/drive/v2internal/files/1iQKKlBU2vuJD1Xet6IYPt7IODVtDHxv1?alt=media&amp;amp;source=downloadUrl&amp;amp;auditContext=fileAction&amp;amp;reason=909&amp;amp;syncType=1&amp;amp;featureLabel=android-sync-classic&amp;amp;openDrive=false&amp;amp;errorRecovery=false&amp;amp;originatorApp=102&lt;/code>&lt;/p>
&lt;h3 id="question-7">Question 7
&lt;/h3>&lt;h4 id="afin-dobtenir-davantage-dinformations-pour-le-contre-espionnage-de-veloria-quel-Ã©tait-lobjectif-principal-de-cette-cyber-opÃ©ration-menÃ©e-par-le-gouvernement-de-ravensk-">Afin d&amp;rsquo;obtenir davantage d&amp;rsquo;informations pour le contre-espionnage de Veloria, quel Ã©tait l&amp;rsquo;objectif principal de cette cyber-opÃ©ration menÃ©e par le gouvernement de Ravensk ?
&lt;/h4>&lt;p>Revenons au document :&lt;/p>
&lt;p>&lt;img src="https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/debrief-velorian-op-text.png"
width="726"
height="584"
srcset="https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/debrief-velorian-op-text_hu15768646427766231920.png 480w, https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/debrief-velorian-op-text_hu4640143542648210762.png 1024w"
loading="lazy"
alt="Debrief-Velorian OP Expansion East"
class="gallery-image"
data-flex-grow="124"
data-flex-basis="298px"
>&lt;/p>
&lt;p>&lt;strong>RÃ©ponse&lt;/strong> :
&lt;code>Infiltrate the Velorian secured network to gather intelligence on upcoming cyber-attacks, their techniques, and target countries.&lt;/code>&lt;/p>
&lt;h3 id="question-8">Question 8
&lt;/h3>&lt;h4 id="lidentification-du-gestionnaire-est-Ã©galement-cruciale-pour-que-les-forces-de-lordre-vÃ©loriennes-puissent-comprendre-lÃ©tendue-de-cette-opÃ©ration-quelle-est-ladresse-Ã©lectronique-utilisÃ©e-par-le-manipulateur-">L&amp;rsquo;identification du gestionnaire est Ã©galement cruciale pour que les forces de l&amp;rsquo;ordre vÃ©loriennes puissent comprendre l&amp;rsquo;Ã©tendue de cette opÃ©ration. Quelle est l&amp;rsquo;adresse Ã©lectronique utilisÃ©e par le manipulateur ?
&lt;/h4>&lt;p>Nous l&amp;rsquo;avons dÃ©jÃ  vu dans les messages de l&amp;rsquo;app MEGA :&lt;/p>
&lt;p>&lt;img src="https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/mega-email.png"
width="818"
height="110"
srcset="https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/mega-email_hu1491445961763267341.png 480w, https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/mega-email_hu10939781081505149858.png 1024w"
loading="lazy"
alt="MEGA"
class="gallery-image"
data-flex-grow="743"
data-flex-basis="1784px"
>&lt;/p>
&lt;p>&lt;strong>RÃ©ponse&lt;/strong> :
&lt;code>ivoryalex783@gmail.com&lt;/code>&lt;/p>
&lt;h3 id="question-9">Question 9
&lt;/h3>&lt;h4 id="quel-est-le-nom-de-lendroit-oÃ¹-lagent-et-le-gestionnaire-se-sont-rencontrÃ©s-">Quel est le nom de l&amp;rsquo;endroit oÃ¹ l&amp;rsquo;agent et le gestionnaire se sont rencontrÃ©s ?
&lt;/h4>&lt;p>Revenons aux messages :&lt;/p>
&lt;p>&lt;img src="https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/mega-message.png"
width="1098"
height="78"
srcset="https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/mega-message_hu16067581850266218057.png 480w, https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/mega-message_hu11319932675825205584.png 1024w"
loading="lazy"
alt="MEGA - Messages"
class="gallery-image"
data-flex-grow="1407"
data-flex-basis="3378px"
>&lt;/p>
&lt;p>C&amp;rsquo;est la question qui m&amp;rsquo;a pris le plus de temps, j&amp;rsquo;ai dÃ» bloquer une bonne heure dessus.&lt;/p>
&lt;p>PremiÃ¨rement, j&amp;rsquo;ai cherchÃ© dans les endroits habituels :&lt;/p>
&lt;ul>
&lt;li>&lt;code>/data/com.google.android.apps.maps/databases/gmm_storage.db&lt;/code>&lt;/li>
&lt;li>&lt;code>/data/com.google.android.apps.maps/databases/search_history.db&lt;/code>&lt;/li>
&lt;li>&lt;code>/data/com.google.android.apps.maps/databases/da_destination_history&lt;/code>&lt;/li>
&lt;li>&lt;code>/data/com.sec.android.daemonapp/db/weatherClock&lt;/code>&lt;/li>
&lt;li>&lt;code>/data/com.google.android.apps.maps/app_tts-cache/&lt;/code>&lt;/li>
&lt;li>&lt;code>/data/com.google.android.apps.maps/cache/image_manager_disk_cache/&lt;/code>&lt;/li>
&lt;/ul>
&lt;p>AprÃ¨s n&amp;rsquo;avoir rien trouvÃ©, je me suis dit qu&amp;rsquo;il Ã©tait sans doute possible que la rÃ©ponse soit dans les metadatas des images sur le tÃ©lÃ©phone. En effet, on retrouve 48 images dont plusieurs de bar :&lt;/p>
&lt;p>&lt;img src="https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/images.png"
width="997"
height="621"
srcset="https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/images_hu5817545336451704280.png 480w, https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/images_hu620833154082632123.png 1024w"
loading="lazy"
alt="Images"
class="gallery-image"
data-flex-grow="160"
data-flex-basis="385px"
>&lt;/p>
&lt;p>NÃ©anmoins, rien de probant.&lt;/p>
&lt;p>Je me suis donc posÃ© plusieurs questions :&lt;/p>
&lt;ul>
&lt;li>il y a-t-il d&amp;rsquo;autres applications de navigation / localisation sur le tÃ©lÃ©phone ?&lt;/li>
&lt;li>est-il sÃ»r que je dois chercher dans l&amp;rsquo;app Google Maps ?&lt;/li>
&lt;/ul>
&lt;ol>
&lt;li>Non, seulement Google Maps.&lt;/li>
&lt;li>Non, il est peut-Ãªtre possible qu&amp;rsquo;il ait fait la recherche sur son navigateur et non sur l&amp;rsquo;app etc.&lt;/li>
&lt;/ol>
&lt;p>Ayant dÃ©jÃ  vÃ©rifiÃ© les points habituels des artefacts de google maps j&amp;rsquo;ai prÃ©fÃ©rÃ© chercher dans le navigateur mais je n&amp;rsquo;ai rien trouvÃ©.&lt;/p>
&lt;p>Je suis donc retournÃ© fouiller dans les artefacts de google maps :&lt;/p>
&lt;p>&lt;img src="https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/liste-artefacts-google-map.png"
width="274"
height="218"
srcset="https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/liste-artefacts-google-map_hu13754758231964912769.png 480w, https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/liste-artefacts-google-map_hu12112553986474291706.png 1024w"
loading="lazy"
alt="artefacts - Google Maps"
class="gallery-image"
data-flex-grow="125"
data-flex-basis="301px"
>&lt;/p>
&lt;ul>
&lt;li>app : RAS&lt;/li>
&lt;li>app_offline_downloads : RAS&lt;/li>
&lt;li>app_offline_hashes : RAS&lt;/li>
&lt;li>app_textures : RAS&lt;/li>
&lt;li>app_webview : RAS&lt;/li>
&lt;li>cache : RAS&lt;/li>
&lt;li>databases : trop de fichiers, j&amp;rsquo;y reviendrai plus tard&lt;/li>
&lt;li>files : &amp;ldquo;new_recent_history_cache_search.cs&amp;rdquo;&lt;/li>
&lt;/ul>
&lt;p>&lt;img src="https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/new_recent_history_cache_search.png"
width="517"
height="278"
srcset="https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/new_recent_history_cache_search_hu13191291403912983547.png 480w, https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/new_recent_history_cache_search_hu3148326987438565339.png 1024w"
loading="lazy"
alt="new_recent_history_cache_search.cs"
class="gallery-image"
data-flex-grow="185"
data-flex-basis="446px"
>&lt;/p>
&lt;p>Je me rends compte que j&amp;rsquo;aurais simplement pu chercher par mot-clÃ© &amp;ldquo;Pub&amp;rdquo; ðŸ¤¡&lt;/p>
&lt;p>&lt;strong>RÃ©ponse&lt;/strong> :
&lt;code>Levstik Pub&lt;/code>&lt;/p>
&lt;h3 id="question-10">Question 10
&lt;/h3>&lt;h4 id="daprÃ¨s-le-chat-retrouvÃ©-entre-lagent-et-le-gestionnaire-il-semble-que-ce-dernier-ait-envoyÃ©-Ã -lagent-arrÃªtÃ©-une-image-relative-Ã -linfrastructure-utilisÃ©e-par-le-gouvernement-ravenskien-pour-cette-opÃ©ration-de-cyberespionnage-quel-est-le-cadre-c2-utilisÃ©-par-le-gouvernement-ravenskien-">D&amp;rsquo;aprÃ¨s le chat retrouvÃ© entre l&amp;rsquo;agent et le gestionnaire, il semble que ce dernier ait envoyÃ© Ã  l&amp;rsquo;agent arrÃªtÃ© une image relative Ã  l&amp;rsquo;infrastructure utilisÃ©e par le gouvernement ravenskien pour cette opÃ©ration de cyberespionnage. Quel est le cadre C2 utilisÃ© par le gouvernement ravenskien ?
&lt;/h4>&lt;p>Ayant dÃ©jÃ  vÃ©rifiÃ© toutes les images pour rÃ©pondre Ã  la question 9 j&amp;rsquo;ai dÃ©jÃ  la rÃ©ponse.&lt;/p>
&lt;p>&lt;img src="https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/c2.png"
width="648"
height="412"
srcset="https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/c2_hu11013950204403249464.png 480w, https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/c2_hu16068086331019550701.png 1024w"
loading="lazy"
alt="C2"
class="gallery-image"
data-flex-grow="157"
data-flex-basis="377px"
>&lt;/p>
&lt;p>&lt;strong>RÃ©ponse&lt;/strong> :
&lt;code>Empire&lt;/code>&lt;/p>
&lt;h3 id="question-11">Question 11
&lt;/h3>&lt;h4 id="la-collecte-dinformations-sur-linfrastructure-telles-que-les-adresses-ip-ou-les-noms-dhÃ´tes-est-cruciale-pour-les-autoritÃ©s-vÃ©loriennes-qui-prÃ©parent-une-opÃ©ration-de-contre-offensive-daprÃ¨s-limage-rÃ©cupÃ©rÃ©e-envoyÃ©e-par-le-gestionnaire-Ã -lagent-quelle-est-ladresse-ip-de-lun-des-serveurs-c2-exploitÃ©s-par-les-acteurs-de-la-menace-ravenskiens-">La collecte d&amp;rsquo;informations sur l&amp;rsquo;infrastructure, telles que les adresses IP ou les noms d&amp;rsquo;hÃ´tes, est cruciale pour les autoritÃ©s vÃ©loriennes, qui prÃ©parent une opÃ©ration de contre-offensive. D&amp;rsquo;aprÃ¨s l&amp;rsquo;image rÃ©cupÃ©rÃ©e envoyÃ©e par le gestionnaire Ã  l&amp;rsquo;agent, quelle est l&amp;rsquo;adresse IP de l&amp;rsquo;un des serveurs C2 exploitÃ©s par les acteurs de la menace ravenskiens ?
&lt;/h4>&lt;p>&lt;strong>RÃ©ponse&lt;/strong> :
&lt;code>98.24.12.45&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/success.png"
width="707"
height="483"
srcset="https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/success_hu1097418382369568901.png 480w, https://jaybird1291.github.io/blog/blog/p/opshieldwall-2/pictures/success_hu5903210077294405049.png 1024w"
loading="lazy"
alt="Success"
class="gallery-image"
data-flex-grow="146"
data-flex-basis="351px"
>&lt;/p></description></item><item><title>OpShieldWall-1</title><link>https://jaybird1291.github.io/blog/p/opshieldwall-1/</link><pubDate>Tue, 07 May 2024 08:00:05 +0000</pubDate><guid>https://jaybird1291.github.io/blog/p/opshieldwall-1/</guid><description>&lt;img src="https://jaybird1291.github.io/blog/p/opshieldwall-1/htb-opshieldwall1.png" alt="Featured image of post OpShieldWall-1" />&lt;h2 id="scÃ©nario">ScÃ©nario
&lt;/h2>&lt;blockquote>
&lt;p>Merci d&amp;rsquo;avoir rÃ©pondu Ã  notre appel. Le ministÃ¨re de la DÃ©fense de Velorian a dÃ©sespÃ©rÃ©ment besoin d&amp;rsquo;aide&amp;hellip;&lt;/p>
&lt;p>Nous devons rester discrets, mais nous pensons que le Wi-Fi public des bureaux du ministÃ¨re de la DÃ©fense de Velorian a Ã©tÃ© compromis. L&amp;rsquo;impact semble faible, mais les diagrammes du rÃ©seau montrent qu&amp;rsquo;aucune segmentation rÃ©elle du rÃ©seau n&amp;rsquo;a Ã©tÃ© rÃ©alisÃ©e et que le trafic entre les appareils est autorisÃ©. Les ministres du gouvernement utilisent ce rÃ©seau avec des Ã©quipements BYoD et des hÃ´tes Velorian MoDNet. Veuillez analyser le pcap fourni et confirmer comment et quand cela s&amp;rsquo;est produit. N&amp;rsquo;oubliez pas que cette enquÃªte est de type TLP Amber.&lt;/p>
&lt;/blockquote>
&lt;h2 id="fichiers">Fichiers
&lt;/h2>&lt;ul>
&lt;li>opshieldwall1.zip contenant la capture rÃ©seau &amp;ldquo;VELORIA-NETWORK.pcap&amp;rdquo;&lt;/li>
&lt;/ul>
&lt;h2 id="setup">Setup
&lt;/h2>&lt;p>Au vu de la simplicitÃ© de ce challenge, on peut simplement se limiter Ã  tshark / wireshark.&lt;/p>
&lt;h2 id="questions">Questions
&lt;/h2>&lt;h3 id="question-1">Question 1
&lt;/h3>&lt;h4 id="veuillez-confirmer-le-ssid-de-notre-rÃ©seau-wifi">Veuillez confirmer le SSID de notre rÃ©seau WiFi.
&lt;/h4>&lt;p>PremiÃ¨rement, familiarisez-nous avec la capture. Nous allons utiliser la commande suivante afin d&amp;rsquo;avoir des statistiques :&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">$ tshark -r traffic.pcapng -qz
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ul>
&lt;li>&lt;code>-r&lt;/code> permet de lire (read) un fichier&lt;/li>
&lt;li>&lt;code>-q&lt;/code> permet d&amp;rsquo;Ãªtre plus &amp;ldquo;quiet&amp;rdquo; Ã  la sortie (utile pour les stats car cela permet d&amp;rsquo;afficher les statistiques globales, et non par paquet.)&lt;/li>
&lt;li>&lt;code>-z&lt;/code> permet l&amp;rsquo;affichage de statistiques&lt;/li>
&lt;/ul>
&lt;p>Il y a beaucoup de valeurs possible (&lt;code>tshark -z help&lt;/code> pour les afficher) mais ici nous souhaitons avant tout savoir :&lt;/p>
&lt;ul>
&lt;li>le nombre de paquet&lt;/li>
&lt;li>la durÃ©e de la capture&lt;/li>
&lt;li>les IPv4 avec le plus de paquet&lt;/li>
&lt;li>les IPv4 endpoints Ã©changeant ensemble le plus&lt;/li>
&lt;li>les protocoles les plus utilisÃ©s&lt;/li>
&lt;/ul>
&lt;p>&lt;strong>Nombre de paquet et durÃ©e :&lt;/strong> 106 ; 31.6 sec&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">$ tshark -r VELORIA-NETWORK.pcap -qz io,stat,0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">===================================&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> IO Statistics &lt;span class="p">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="p">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Duration: 31.6 secs &lt;span class="p">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Interval: 31.6 secs &lt;span class="p">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="p">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Col 1: Frames and bytes &lt;span class="p">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>---------------------------------&lt;span class="p">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="p">|&lt;/span>&lt;span class="m">1&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="p">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Interval &lt;span class="p">|&lt;/span> Frames &lt;span class="p">|&lt;/span> Bytes &lt;span class="p">|&lt;/span> &lt;span class="p">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>-------------------------------&lt;span class="p">|&lt;/span> &lt;span class="p">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> 0.0 &amp;lt;&amp;gt; 31.6 &lt;span class="p">|&lt;/span> &lt;span class="m">106&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="m">20759&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="p">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">===================================&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;strong>IPv4 endpoints :&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>avec le plus de paquet :&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">$ tshark -r VELORIA-NETWORK.pcap -qz endpoints,ip
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">================================================================================&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">IPv4 Endpoints
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Filter:&amp;lt;No Filter&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">|&lt;/span> Packets &lt;span class="p">|&lt;/span> &lt;span class="p">|&lt;/span> Bytes &lt;span class="p">|&lt;/span> &lt;span class="p">|&lt;/span> Tx Packets &lt;span class="p">|&lt;/span> &lt;span class="p">|&lt;/span> Tx Bytes &lt;span class="p">|&lt;/span> &lt;span class="p">|&lt;/span> Rx Packets &lt;span class="p">|&lt;/span> &lt;span class="p">|&lt;/span> Rx Bytes &lt;span class="p">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">0.0.0.0 &lt;span class="m">3&lt;/span> &lt;span class="m">1044&lt;/span> &lt;span class="m">3&lt;/span> &lt;span class="m">1044&lt;/span> &lt;span class="m">0&lt;/span> &lt;span class="m">0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">255.255.255.255 &lt;span class="m">3&lt;/span> &lt;span class="m">1044&lt;/span> &lt;span class="m">0&lt;/span> &lt;span class="m">0&lt;/span> &lt;span class="m">3&lt;/span> &lt;span class="m">1044&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">10.0.3.1 &lt;span class="m">3&lt;/span> &lt;span class="m">1048&lt;/span> &lt;span class="m">3&lt;/span> &lt;span class="m">1048&lt;/span> &lt;span class="m">0&lt;/span> &lt;span class="m">0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">10.0.3.52 &lt;span class="m">3&lt;/span> &lt;span class="m">1048&lt;/span> &lt;span class="m">0&lt;/span> &lt;span class="m">0&lt;/span> &lt;span class="m">3&lt;/span> &lt;span class="nv">1048&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">================================================================================&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ul>
&lt;li>Ã©changeant le plus :&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;span class="lnt">9
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">tshark -r VELORIA-NETWORK.pcap -qz conv,ip
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">================================================================================&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">IPv4 Conversations
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Filter:&amp;lt;No Filter&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">|&lt;/span> &amp;lt;- &lt;span class="p">|&lt;/span> &lt;span class="p">|&lt;/span> -&amp;gt; &lt;span class="p">|&lt;/span> &lt;span class="p">|&lt;/span> Total &lt;span class="p">|&lt;/span> Relative &lt;span class="p">|&lt;/span> Duration &lt;span class="p">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">|&lt;/span> Frames Bytes &lt;span class="p">|&lt;/span> &lt;span class="p">|&lt;/span> Frames Bytes &lt;span class="p">|&lt;/span> &lt;span class="p">|&lt;/span> Frames Bytes &lt;span class="p">|&lt;/span> Start &lt;span class="p">|&lt;/span> &lt;span class="p">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">0.0.0.0 &amp;lt;-&amp;gt; 255.255.255.255 &lt;span class="m">0&lt;/span> &lt;span class="m">0&lt;/span> bytes &lt;span class="m">3&lt;/span> &lt;span class="m">1044&lt;/span> bytes &lt;span class="m">3&lt;/span> &lt;span class="m">1044&lt;/span> bytes 23.256576000 8.3680
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">10.0.3.1 &amp;lt;-&amp;gt; 10.0.3.52 &lt;span class="m">0&lt;/span> &lt;span class="m">0&lt;/span> bytes &lt;span class="m">3&lt;/span> &lt;span class="m">1048&lt;/span> bytes &lt;span class="m">3&lt;/span> &lt;span class="m">1048&lt;/span> bytes 23.256959000 8.3693
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">================================================================================&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;strong>Protocoles les plus utilisÃ©s :&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">tshark -r VELORIA-NETWORK.pcap -qz io,phs
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">===================================================================&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Protocol Hierarchy Statistics
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Filter:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sll frames:106 bytes:20759
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> radiotap frames:92 bytes:17572
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> wlan_radio frames:92 bytes:17572
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> wlan frames:92 bytes:17572
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> wlan.mgt frames:92 bytes:17572
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> eapol frames:6 bytes:999
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> eap frames:6 bytes:999
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ip frames:6 bytes:2092
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> udp frames:6 bytes:2092
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> dhcp frames:6 bytes:2092
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> arp frames:2 bytes:96
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">===================================================================&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Pour rÃ©pondre Ã  la question, il suffit d&amp;rsquo;utiliser la commande :&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">$ tshark -r VELORIA-NETWORK.pcap -T fields -e wlan.ssid &lt;span class="p">|&lt;/span> head -n &lt;span class="m">1&lt;/span> &lt;span class="p">|&lt;/span> xxd -r -p
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">VELORIA-MoD-AP012
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;strong>Explication&lt;/strong> :
(&lt;a class="link" href="https://www.wireshark.org/docs/dfref/w/wlan.html" target="_blank" rel="noopener"
>https://www.wireshark.org/docs/dfref/w/wlan.html&lt;/a>)&lt;/p>
&lt;ul>
&lt;li>&lt;code>-t&lt;/code> affiche uniquement les champs spÃ©cifiÃ©s par l&amp;rsquo;utilisateur (nÃ©cessite donc forcÃ©ment l&amp;rsquo;utilisation de l&amp;rsquo;option -e pour spÃ©cifier les champs).&lt;/li>
&lt;li>&lt;code>-e wlan.ssid&lt;/code> spÃ©cifie que le champ wlan.ssid (SSID des rÃ©seaux sans fil) doit Ãªtre extrait et affichÃ©.&lt;/li>
&lt;li>&lt;code>-xxd -r -p&lt;/code> l&amp;rsquo;output Ã©tant une suite hexadÃ©cimale, cela permet de le convertir en texte lisible&lt;/li>
&lt;/ul>
&lt;p>&lt;strong>RÃ©ponse&lt;/strong> :
&lt;code>VELORIA-MoD-AP012&lt;/code>&lt;/p>
&lt;h3 id="question-2">Question 2
&lt;/h3>&lt;h4 id="veuillez-confirmer-ladresse-mac-du-point-daccÃ¨s-ap">Veuillez confirmer l&amp;rsquo;adresse MAC du point d&amp;rsquo;accÃ¨s (AP).
&lt;/h4>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">tshark -r VELORIA-NETWORK.pcap -T fields -e wlan.sa &lt;span class="p">|&lt;/span> head -n &lt;span class="m">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">02:00:00:00:01:00
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;strong>RÃ©ponse&lt;/strong> :
&lt;code>02:00:00:00:01:00&lt;/code>&lt;/p>
&lt;h3 id="question-3">Question 3
&lt;/h3>&lt;h4 id="veuillez-confirmer-lÃ©tatle-mÃ©canisme-dauthentification-de-lap-et-le-vecteur-dattaque">Veuillez confirmer l&amp;rsquo;Ã©tat/le mÃ©canisme d&amp;rsquo;authentification de l&amp;rsquo;AP et le vecteur d&amp;rsquo;attaque.
&lt;/h4>&lt;p>Passons Ã  Wireshark.&lt;/p>
&lt;p>&lt;img src="https://jaybird1291.github.io/blog/blog/p/opshieldwall-1/pictures/image.png"
width="944"
height="116"
srcset="https://jaybird1291.github.io/blog/blog/p/opshieldwall-1/pictures/image_hu616452334496551155.png 480w, https://jaybird1291.github.io/blog/blog/p/opshieldwall-1/pictures/image_hu8139663477600881612.png 1024w"
loading="lazy"
alt="SÃ©quence EAP (Extensible Authentication Protocol)"
class="gallery-image"
data-flex-grow="813"
data-flex-basis="1953px"
>&lt;/p>
&lt;p>&lt;strong>RÃ©ponse&lt;/strong> :
&lt;code>WPS&lt;/code>&lt;/p>
&lt;h3 id="question-4">Question 4
&lt;/h3>&lt;h4 id="quel-est-le-numÃ©ro-de-paquet-oÃ¹-lattaque-a-t-elle-commencÃ©-">Quel est le numÃ©ro de paquet oÃ¹ l&amp;rsquo;attaque a-t-elle commencÃ© ?
&lt;/h4>&lt;p>On peut facilement en dÃ©duire que c&amp;rsquo;est Ã  la premiÃ¨re tentative de connexion (Ã©tant les seuls dans la capture).&lt;/p>
&lt;p>&lt;strong>RÃ©ponse&lt;/strong> :
&lt;code>93&lt;/code>&lt;/p>
&lt;h3 id="question-5">Question 5
&lt;/h3>&lt;h4 id="quel-est-le-numÃ©ro-de-paquet-oÃ¹-lattaque-sest-elle-terminÃ©e-">Quel est le numÃ©ro de paquet oÃ¹ l&amp;rsquo;attaque s&amp;rsquo;est-elle terminÃ©e ?
&lt;/h4>&lt;p>On peut facilement en dÃ©duire que c&amp;rsquo;est lorsque l&amp;rsquo;authentifcation a Ã©chouÃ©.&lt;/p>
&lt;p>&lt;strong>RÃ©ponse&lt;/strong> :
&lt;code>8&lt;/code>&lt;/p></description></item></channel></rss>